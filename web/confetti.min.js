let e="PixelPlush Confetti",a={},n={},t="",o=1;function s(){PIXI.settings.SCALE_MODE=PIXI.SCALE_MODES.NEAREST,n.snow&&Unicorn.AddParticles("snowupdown",{blendMode:PIXI.BLEND_MODES.DEFAULT,shape:"line",angle:Math.PI/2,startColor:"#ffffff",endColor:"#ffffff",intensity:2,minSpeed:.05,maxSpeed:.2,decay:15},0,-200),n.leaves&&(Unicorn.Load("leaf_gold",t+"/assets/game-parachute/autumn_theme/leaf_gold.png"),Unicorn.Load("leaf1",t+"/assets/game-parachute/autumn_theme/leaf1.png"),Unicorn.Load("leaf2",t+"/assets/game-parachute/autumn_theme/leaf2.png"),Unicorn.Load("leaf3",t+"/assets/game-parachute/autumn_theme/leaf3.png"),Unicorn.Load("leaf4",t+"/assets/game-parachute/autumn_theme/leaf4.png"),Unicorn.Load("leaf5",t+"/assets/game-parachute/autumn_theme/leaf5.png"),Unicorn.Load("leaf6",t+"/assets/game-parachute/autumn_theme/leaf6.png"),Unicorn.Load("oak_gold",t+"/assets/game-parachute/autumn_theme/oak_gold.png"),Unicorn.Load("oak1",t+"/assets/game-parachute/autumn_theme/oak1.png"),Unicorn.Load("oak2",t+"/assets/game-parachute/autumn_theme/oak2.png"),Unicorn.Load("oak3",t+"/assets/game-parachute/autumn_theme/oak3.png"),Unicorn.Load("oak4",t+"/assets/game-parachute/autumn_theme/oak4.png"),Unicorn.Load("oak5",t+"/assets/game-parachute/autumn_theme/oak5.png"),Unicorn.Load("oak6",t+"/assets/game-parachute/autumn_theme/oak6.png")),n.snowflakes&&(Unicorn.Load("snowflake1",t+"/assets/game-parachute/christmas_theme/snowflake_1.png"),Unicorn.Load("snowflake2",t+"/assets/game-parachute/christmas_theme/snowflake_2.png"))}const l=["leaf1","leaf2","leaf3","leaf4","leaf5","leaf6","oak1","oak2","oak3","oak4","oak5","oak6"],f=["snowflake1","snowflake2"];let c=0,r=[],h=[];function i(e){let a=n.leaves2?k(1080):k(2160)-1080,t=k(10),o="leaf_"+ ++c,s=Unicorn.AddBacklay(o,e,-100,a,{scale:{x:2,y:2}});s.name=o,s.progress=0,s.offset=t,r.push(s)}function u(e){let a=k(10),n="snow_"+ ++c,t=Unicorn.AddBacklay(n,e,k(1920),-100,{scale:{x:2,y:2}});t.name=n,t.progress=0,t.offset=a,h.push(t)}function m(e,a){const t=a/1e3;for(let e=0;e<r.length;e++){let a=r[e].progress+=t/10;a>=1?(Unicorn.RemoveBacklay(r[e].name),r.splice(e--,1)):n.leaves2?(r[e].x=2480*Math.sin(a)-100,r[e].y+=Math.sin(20*a+r[e].offset),r[e].angle=10*Math.cos(20*a)+60*r[e].offset):(r[e].x=2480*Math.sin(a)-100,r[e].y+=t/10*1080+r[e].offset/10+Math.sin(20*a+r[e].offset),r[e].angle=10*Math.cos(20*a)+60*r[e].offset)}for(let e=0;e<h.length;e++){let a=h[e].progress+=t/10;a>=1?(Unicorn.RemoveBacklay(h[e].name),h.splice(e--,1)):(h[e].y+=t/10*1180+h[e].offset/10+Math.sin(20*a+h[e].offset),h[e].angle=10*Math.cos(20*a)+60*h[e].offset)}}function p(e,a,t,o,s){if(o.mod||o.broadcaster||o.vip){if("leaf"===a){const e=parseInt(t||"10"),a=4;for(let t=0;t<a;t++)for(let t=0;t<e/a;t++)setTimeout((()=>{i(l[k(l.length)])}),(n.leaves2?100:150)*(t+a)+k(n.leaves2?100:2e3))}if("snow"===a){const e=parseInt(t||"10"),a=4;for(let t=0;t<a;t++)for(let t=0;t<e/a;t++)setTimeout((()=>{u(f[k(f.length)])}),(n.leaves2?100:150)*(t+a)+k(n.leaves2?100:2e3))}}}let g=0;function d(e,a,t,s,c){g=(g+1)%o,0===g&&((n.leaves||n.leaves2)&&i(l[k(l.length)]),n.snowflakes&&u(f[k(f.length)]))}function k(e){return Math.floor(e*Math.random())}var _="";async function U(){return fetch("https://api.pixelplush.dev/v1/analytics/heartbeat",{method:"POST",body:JSON.stringify({session:_,game:"confetti",theme:e,channel:n.channel,players:[n.channel],count:1})}).then((e=>e.json()))}window.setupGame=function(l,f,c){e=l,a=f,n=c,t=a.path||"",o=c.nth||1,Unicorn.Create("unicorn-display",{width:1920,height:1080,background:"transparent",init:s,update:m,channel:n.channel,username:n.oauth?n.channel:void 0,password:n.oauth,onCommand:p,onChat:d,gravity:{x:0,y:0}}),ComfyJS.onConnected=async(e,a,n)=>{if(n){let e=await U();0!==e&&(_=e.session,setInterval((()=>{U()}),6e4))}}};